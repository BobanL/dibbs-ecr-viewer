<!DOCTYPE html><html class="default" lang="en" data-base="../"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>Setup Guide | ecr-viewer</title><meta name="description" content="Documentation for ecr-viewer"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css"/><link rel="stylesheet" href="../assets/highlight.css"/><script defer src="../assets/main.js"></script><script async src="../assets/icons.js" id="tsd-icons-script"></script><script async src="../assets/search.js" id="tsd-search-script"></script><script async src="../assets/navigation.js" id="tsd-nav-script"></script><script async src="../assets/hierarchy.js" id="tsd-hierarchy-script"></script>
<style>
:root.mermaid-enabled .mermaid-block > pre {
  display: none;
}
:root:not(.mermaid-enabled) .mermaid-block > .mermaid {
  display: none !important;
}

.mermaid-block > .mermaid[data-inserted].dark {
  display: var(--mermaid-dark-display);
}
.mermaid-block > .mermaid[data-inserted].light {
  display: var(--mermaid-light-display);
}

:root {
  --mermaid-dark-display: none;
  --mermaid-light-display: block;
}
@media (prefers-color-scheme: light) {
  :root {
    --mermaid-dark-display: none;
    --mermaid-light-display: block;
  }
}
@media (prefers-color-scheme: dark) {
  :root {
    --mermaid-dark-display: block;
    --mermaid-light-display: none;
  }
}
body.light, :root[data-theme="light"] {
  --mermaid-dark-display: none;
  --mermaid-light-display: block;
}
body.dark, :root[data-theme="dark"] {
  --mermaid-dark-display: block;
  --mermaid-light-display: none;
}
</style>
</head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="../index.html" class="title">ecr-viewer</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb" aria-label="Breadcrumb"><li><a href="" aria-current="page">Setup Guide</a></li></ul></div><div class="tsd-panel tsd-typography"><h1 id="ecr-viewer-setup-guide" class="tsd-anchor-link">eCR Viewer Setup Guide<a href="#ecr-viewer-setup-guide" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h1><h2 id="general-background" class="tsd-anchor-link">General Background<a href="#general-background" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The eCR Viewer can be run in three modes.</p>
<table>
<thead>
<tr>
<th>MODE</th>
<th>Features Available</th>
<th>Metadata Support</th>
<th>Authentication Supported</th>
<th>Environment Variables Needed</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>INTEGRATED</code></td>
<td>Viewer</td>
<td>None</td>
<td>NBS</td>
<td><a href="#base-required">Base</a>, <a href="#integrated-authentication">Integrated Authentication</a></td>
</tr>
<tr>
<td><code>NON_INTEGRATED</code></td>
<td>Viewer, Library</td>
<td>SQLSERVER or PG</td>
<td>External authentication provider</td>
<td><a href="#base-required">Base</a>, <a href="#non-integrated-authentication">Non Integrated Authentication</a>, <a href="#metadata---ecr-library">Metadata Database</a></td>
</tr>
<tr>
<td><code>DUAL</code></td>
<td>Viewer, Library</td>
<td>SQLSERVER or PG</td>
<td>Both NBS and external authentication provider</td>
<td><a href="#base-required">Base</a>, <a href="#integrated-authentication">Integrated Authentication</a>, <a href="#non-integrated-authentication">Non Integrated Authentication</a>, <a href="#metadata---ecr-library">Metadata Database</a></td>
</tr>
</tbody>
</table>
<h3 id="integrated-architecture-diagram" class="tsd-anchor-link">Integrated Architecture Diagram<a href="#integrated-architecture-diagram" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><div class="mermaid-block"><div class="mermaid dark">%%{init:{"theme":"dark"}}%%
flowchart LR
  user
  nbs[&quot;NBS - View eICR&quot;]
  ingestion[&quot;Ingestion Service&lt;br&gt;(e.g. Rhapsody)&quot;]
  subgraph service[Cloud]
    direction TB
    subgraph container[&quot;fab:fa-docker container&quot;]
      viewer[&quot;fab:fa-node fab:fa-react &lt;code&gt;ecr-viewer&lt;br&gt;HTTP:3000/&lt;/code&gt;&quot;]
    end
    fileStorage[&quot;fab:fa-file File Storage&quot;]
	container &lt;--&gt; |eCR FHIR Data| fileStorage
  end
  user --&gt; nbs
  nbs --&gt;|&lt;code&gt;/view-data&lt;/code&gt;&lt;br&gt;eCR Viewer&lt;br&gt;Authenticated by NBS| container
  ingestion --&gt;|&lt;code&gt;/api/save-fhir-data&lt;/code&gt;| container</div><div class="mermaid light">%%{init:{"theme":"default"}}%%
flowchart LR
  user
  nbs[&quot;NBS - View eICR&quot;]
  ingestion[&quot;Ingestion Service&lt;br&gt;(e.g. Rhapsody)&quot;]
  subgraph service[Cloud]
    direction TB
    subgraph container[&quot;fab:fa-docker container&quot;]
      viewer[&quot;fab:fa-node fab:fa-react &lt;code&gt;ecr-viewer&lt;br&gt;HTTP:3000/&lt;/code&gt;&quot;]
    end
    fileStorage[&quot;fab:fa-file File Storage&quot;]
	container &lt;--&gt; |eCR FHIR Data| fileStorage
  end
  user --&gt; nbs
  nbs --&gt;|&lt;code&gt;/view-data&lt;/code&gt;&lt;br&gt;eCR Viewer&lt;br&gt;Authenticated by NBS| container
  ingestion --&gt;|&lt;code&gt;/api/save-fhir-data&lt;/code&gt;| container</div><pre><code class="language-mermaid">flowchart LR
  user
  nbs[&quot;NBS - View eICR&quot;]
  ingestion[&quot;Ingestion Service&lt;br&gt;(e.g. Rhapsody)&quot;]
  subgraph service[Cloud]
    direction TB
    subgraph container[&quot;fab:fa-docker container&quot;]
      viewer[&quot;fab:fa-node fab:fa-react &lt;code&gt;ecr-viewer&lt;br&gt;HTTP:3000/&lt;/code&gt;&quot;]
    end
    fileStorage[&quot;fab:fa-file File Storage&quot;]
	container &lt;--&gt; |eCR FHIR Data| fileStorage
  end
  user --&gt; nbs
  nbs --&gt;|&lt;code&gt;/view-data&lt;/code&gt;&lt;br&gt;eCR Viewer&lt;br&gt;Authenticated by NBS| container
  ingestion --&gt;|&lt;code&gt;/api/save-fhir-data&lt;/code&gt;| container</code></pre></div>
<h3 id="non-integrated-architecture-diagram" class="tsd-anchor-link">Non Integrated Architecture Diagram<a href="#non-integrated-architecture-diagram" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><div class="mermaid-block"><div class="mermaid dark">%%{init:{"theme":"dark"}}%%
flowchart LR
  user
  ingestion[&quot;Ingestion Service&lt;br&gt;(e.g. Rhapsody)&quot;]
  subgraph service[Cloud]
    direction TB
    subgraph container[&quot;fab:fa-docker container&quot;]
      viewer[&quot;fab:fa-node fab:fa-react &lt;code&gt;ecr-viewer&lt;br&gt;HTTP:3000/&lt;/code&gt;&quot;]
    end
    fileStorage[&quot;fab:fa-file File Storage&quot;]
    metadata[&quot;fab:fa-database Database&quot;]
    identityProvider[&quot;Identity Provider&lt;br&gt;(e.g. Keycloak/Azure Ad)&quot;]
	container &lt;--&gt; |eCR FHIR Data| fileStorage
	container &lt;--&gt; |eCR Metadata| metadata
    container --&gt;|Validates User| identityProvider
  end
  user --&gt;|&lt;code&gt;/view-data&lt;/code&gt;&lt;br&gt;eCR Viewer&lt;br&gt;Authenticated by identity provider| container
  user --&gt;|&lt;code&gt;/&lt;/code&gt;&lt;br&gt;eCR Library&lt;br&gt;Authenticated By identity provider| container
  ingestion --&gt;|&lt;code&gt;/api/save-fhir-data&lt;/code&gt;| container</div><div class="mermaid light">%%{init:{"theme":"default"}}%%
flowchart LR
  user
  ingestion[&quot;Ingestion Service&lt;br&gt;(e.g. Rhapsody)&quot;]
  subgraph service[Cloud]
    direction TB
    subgraph container[&quot;fab:fa-docker container&quot;]
      viewer[&quot;fab:fa-node fab:fa-react &lt;code&gt;ecr-viewer&lt;br&gt;HTTP:3000/&lt;/code&gt;&quot;]
    end
    fileStorage[&quot;fab:fa-file File Storage&quot;]
    metadata[&quot;fab:fa-database Database&quot;]
    identityProvider[&quot;Identity Provider&lt;br&gt;(e.g. Keycloak/Azure Ad)&quot;]
	container &lt;--&gt; |eCR FHIR Data| fileStorage
	container &lt;--&gt; |eCR Metadata| metadata
    container --&gt;|Validates User| identityProvider
  end
  user --&gt;|&lt;code&gt;/view-data&lt;/code&gt;&lt;br&gt;eCR Viewer&lt;br&gt;Authenticated by identity provider| container
  user --&gt;|&lt;code&gt;/&lt;/code&gt;&lt;br&gt;eCR Library&lt;br&gt;Authenticated By identity provider| container
  ingestion --&gt;|&lt;code&gt;/api/save-fhir-data&lt;/code&gt;| container</div><pre><code class="language-mermaid">flowchart LR
  user
  ingestion[&quot;Ingestion Service&lt;br&gt;(e.g. Rhapsody)&quot;]
  subgraph service[Cloud]
    direction TB
    subgraph container[&quot;fab:fa-docker container&quot;]
      viewer[&quot;fab:fa-node fab:fa-react &lt;code&gt;ecr-viewer&lt;br&gt;HTTP:3000/&lt;/code&gt;&quot;]
    end
    fileStorage[&quot;fab:fa-file File Storage&quot;]
    metadata[&quot;fab:fa-database Database&quot;]
    identityProvider[&quot;Identity Provider&lt;br&gt;(e.g. Keycloak/Azure Ad)&quot;]
	container &lt;--&gt; |eCR FHIR Data| fileStorage
	container &lt;--&gt; |eCR Metadata| metadata
    container --&gt;|Validates User| identityProvider
  end
  user --&gt;|&lt;code&gt;/view-data&lt;/code&gt;&lt;br&gt;eCR Viewer&lt;br&gt;Authenticated by identity provider| container
  user --&gt;|&lt;code&gt;/&lt;/code&gt;&lt;br&gt;eCR Library&lt;br&gt;Authenticated By identity provider| container
  ingestion --&gt;|&lt;code&gt;/api/save-fhir-data&lt;/code&gt;| container</code></pre></div>
<h3 id="dual-architecture-diagram" class="tsd-anchor-link">Dual Architecture Diagram<a href="#dual-architecture-diagram" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><div class="mermaid-block"><div class="mermaid dark">%%{init:{"theme":"dark"}}%%
flowchart LR
  user
  nbs[&quot;NBS - View eICR&quot;]
  ingestion[&quot;Ingestion Service&lt;br&gt;(e.g. Rhapsody)&quot;]
  subgraph service[Cloud]
    direction TB
    subgraph container[&quot;fab:fa-docker container&quot;]
      viewer[&quot;fab:fa-node fab:fa-react &lt;code&gt;ecr-viewer&lt;br&gt;HTTP:3000/&lt;/code&gt;&quot;]
    end
    fileStorage[&quot;fab:fa-file File Storage&quot;]
    metadata[&quot;fab:fa-database Database&quot;]
    identityProvider[&quot;Identity Provider&lt;br&gt;(e.g. Keycloak/Azure Ad)&quot;]
	container &lt;--&gt; |eCR FHIR Data| fileStorage
	container &lt;--&gt; |eCR Metadata| metadata
    container --&gt;|Validates User| identityProvider
  end
  user --&gt; nbs
  nbs --&gt;|&lt;code&gt;/view-data&lt;/code&gt;&lt;br&gt;eCR Viewer&lt;br&gt;Authenticated by NBS| container
  user --&gt;|&lt;code&gt;/view-data&lt;/code&gt;&lt;br&gt;eCR Viewer&lt;br&gt;Authenticated by identity provider| container
  user --&gt;|&lt;code&gt;/&lt;/code&gt;&lt;br&gt;eCR Library&lt;br&gt;Authenticated By identity provider| container
  ingestion --&gt;|&lt;code&gt;/api/save-fhir-data&lt;/code&gt;| container</div><div class="mermaid light">%%{init:{"theme":"default"}}%%
flowchart LR
  user
  nbs[&quot;NBS - View eICR&quot;]
  ingestion[&quot;Ingestion Service&lt;br&gt;(e.g. Rhapsody)&quot;]
  subgraph service[Cloud]
    direction TB
    subgraph container[&quot;fab:fa-docker container&quot;]
      viewer[&quot;fab:fa-node fab:fa-react &lt;code&gt;ecr-viewer&lt;br&gt;HTTP:3000/&lt;/code&gt;&quot;]
    end
    fileStorage[&quot;fab:fa-file File Storage&quot;]
    metadata[&quot;fab:fa-database Database&quot;]
    identityProvider[&quot;Identity Provider&lt;br&gt;(e.g. Keycloak/Azure Ad)&quot;]
	container &lt;--&gt; |eCR FHIR Data| fileStorage
	container &lt;--&gt; |eCR Metadata| metadata
    container --&gt;|Validates User| identityProvider
  end
  user --&gt; nbs
  nbs --&gt;|&lt;code&gt;/view-data&lt;/code&gt;&lt;br&gt;eCR Viewer&lt;br&gt;Authenticated by NBS| container
  user --&gt;|&lt;code&gt;/view-data&lt;/code&gt;&lt;br&gt;eCR Viewer&lt;br&gt;Authenticated by identity provider| container
  user --&gt;|&lt;code&gt;/&lt;/code&gt;&lt;br&gt;eCR Library&lt;br&gt;Authenticated By identity provider| container
  ingestion --&gt;|&lt;code&gt;/api/save-fhir-data&lt;/code&gt;| container</div><pre><code class="language-mermaid">flowchart LR
  user
  nbs[&quot;NBS - View eICR&quot;]
  ingestion[&quot;Ingestion Service&lt;br&gt;(e.g. Rhapsody)&quot;]
  subgraph service[Cloud]
    direction TB
    subgraph container[&quot;fab:fa-docker container&quot;]
      viewer[&quot;fab:fa-node fab:fa-react &lt;code&gt;ecr-viewer&lt;br&gt;HTTP:3000/&lt;/code&gt;&quot;]
    end
    fileStorage[&quot;fab:fa-file File Storage&quot;]
    metadata[&quot;fab:fa-database Database&quot;]
    identityProvider[&quot;Identity Provider&lt;br&gt;(e.g. Keycloak/Azure Ad)&quot;]
	container &lt;--&gt; |eCR FHIR Data| fileStorage
	container &lt;--&gt; |eCR Metadata| metadata
    container --&gt;|Validates User| identityProvider
  end
  user --&gt; nbs
  nbs --&gt;|&lt;code&gt;/view-data&lt;/code&gt;&lt;br&gt;eCR Viewer&lt;br&gt;Authenticated by NBS| container
  user --&gt;|&lt;code&gt;/view-data&lt;/code&gt;&lt;br&gt;eCR Viewer&lt;br&gt;Authenticated by identity provider| container
  user --&gt;|&lt;code&gt;/&lt;/code&gt;&lt;br&gt;eCR Library&lt;br&gt;Authenticated By identity provider| container
  ingestion --&gt;|&lt;code&gt;/api/save-fhir-data&lt;/code&gt;| container</code></pre></div>
<h2 id="environment-variable-setup" class="tsd-anchor-link">Environment Variable Setup<a href="#environment-variable-setup" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The full list of environment variables can be found in <a href="../interfaces/environment.NodeJS.ProcessEnv.html" class="tsd-kind-interface"> NodeJS.ProcessEnv</a></p>
<h3 id="base-required" class="tsd-anchor-link">Base Required<a href="#base-required" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>These variables are required for all deployments. If variables are not set, this may cause issues running the app.</p>
<pre><code class="ts"><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> Base Required</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Base path for the eCR Viewer.</span><br/><span class="hl-3"> * </span><span class="hl-4">@example</span><span class="hl-3"> /ecr-viewer</span><br/><span class="hl-3"> */</span><br/><span class="hl-5">BASE_PATH</span><span class="hl-0">: </span><span class="hl-1">string</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> Base Required</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Configuration name that determines the type of authentication used, metadata database, and eCR document storage type.</span><br/><span class="hl-3"> */</span><br/><span class="hl-5">CONFIG_NAME</span><span class="hl-0">:</span><br/><span class="hl-0">  | </span><span class="hl-6">&quot;AWS_INTEGRATED&quot;</span><br/><span class="hl-0">  | </span><span class="hl-6">&quot;AWS_PG_NON_INTEGRATED&quot;</span><br/><span class="hl-0">  | </span><span class="hl-6">&quot;AWS_SQLSERVER_NON_INTEGRATED&quot;</span><br/><span class="hl-0">  | </span><span class="hl-6">&quot;AWS_PG_DUAL&quot;</span><br/><span class="hl-0">  | </span><span class="hl-6">&quot;AWS_SQLSERVER_DUAL&quot;</span><br/><span class="hl-0">  | </span><span class="hl-6">&quot;AZURE_INTEGRATED&quot;</span><br/><span class="hl-0">  | </span><span class="hl-6">&quot;AZURE_PG_NON_INTEGRATED&quot;</span><br/><span class="hl-0">  | </span><span class="hl-6">&quot;AZURE_SQLSERVER_NON_INTEGRATED&quot;</span><br/><span class="hl-0">  | </span><span class="hl-6">&quot;AZURE_PG_DUAL&quot;</span><br/><span class="hl-0">  | </span><span class="hl-6">&quot;AZURE_SQLSERVER_DUAL&quot;</span><br/><span class="hl-0">  | </span><span class="hl-6">&quot;GCP_INTEGRATED&quot;</span><br/><span class="hl-0">  | </span><span class="hl-6">&quot;GCP_PG_NON_INTEGRATED&quot;</span><br/><span class="hl-0">  | </span><span class="hl-6">&quot;GCP_SQLSERVER_NON_INTEGRATED&quot;</span><br/><span class="hl-0">  | </span><span class="hl-6">&quot;GCP_PG_DUAL&quot;</span><br/><span class="hl-0">  | </span><span class="hl-6">&quot;GCP_SQLSERVER_DUAL&quot;</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> Base Required</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Name of the Container storage where eCR documents are stored.</span><br/><span class="hl-3"> */</span><br/><span class="hl-5">ECR_BUCKET_NAME</span><span class="hl-0">: </span><span class="hl-1">string</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> Base Required</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> The full URL that the orchestration URL is available at.</span><br/><span class="hl-3"> */</span><br/><span class="hl-5">ORCHESTRATION_URL</span><span class="hl-0">: </span><span class="hl-1">string</span><span class="hl-0">;</span>
</code><button type="button">Copy</button></pre>

<p>In addition, an storage container for the eCRs must be created. Certain values may need to be set depending on the storage provider used.</p>
<pre><code class="ts"><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> eCR Storage - AWS</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> AWS access key ID for accessing AWS services.</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">AWS_ACCESS_KEY_ID</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@ignore</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> eCR Storage - AWS</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Custom endpoint URL for AWS services. This is used for local development only.</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">AWS_CUSTOM_ENDPOINT</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> eCR Storage - AWS</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> AWS region where resources are located.</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">AWS_REGION</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> eCR Storage - AWS</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> AWS secret access key for accessing AWS services.</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">AWS_SECRET_ACCESS_KEY</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span>
</code><button type="button">Copy</button></pre>

<pre><code class="ts"><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> eCR Storage - AZURE</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Azure Blob Storage container name where eCR documents are stored.</span><br/><span class="hl-3"> * </span><span class="hl-4">@deprecated</span><span class="hl-3"> Since v3.1.0 - Use </span><span class="hl-8">{</span><span class="hl-4">@link</span><span class="hl-8"> </span><span class="hl-1">ECR_BUCKET_NAME</span><span class="hl-8">}</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">AZURE_CONTAINER_NAME</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> eCR Storage - AZURE</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Connection string for Azure Storage account. Required for Azure Blob Storage.</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">AZURE_STORAGE_CONNECTION_STRING</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span>
</code><button type="button">Copy</button></pre>

<pre><code class="ts"><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> eCR Storage - GCP</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Google Cloud service account credentials JSON (stringified) for GCP deployments.</span><br/><span class="hl-3"> * Only required if not using Application Default Credentials.</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">GCP_CREDENTIALS</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> eCR Storage - GCP</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Google Cloud project ID where resources are located.</span><br/><span class="hl-3"> * Only required if not using Application Default Credentials.</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">GCP_PROJECT_ID</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@ignore</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> eCR Storage - GCP</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Custom endpoint URL for GCP services. This is used for local development only.</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">GCP_API_ENDPOINT</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span>
</code><button type="button">Copy</button></pre>

<h3 id="authentication-setup" class="tsd-anchor-link">Authentication Setup<a href="#authentication-setup" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Some form of authentication will be required on the application.</p>
<h4 id="integrated-authentication" class="tsd-anchor-link">Integrated Authentication<a href="#integrated-authentication" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Integrated eCR Viewer will rely on NBS to authenticate the user.</p>
<pre><code class="ts"><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> Authentication - NBS</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Public key for NBS authentication.</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">NBS_PUB_KEY</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span>
</code><button type="button">Copy</button></pre>

<h4 id="non-integrated-authentication" class="tsd-anchor-link">Non Integrated Authentication<a href="#non-integrated-authentication" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h4><p>Non-Integrated will relies on an external authentication provider (like azure ad, entra, or keycloak).</p>
<pre><code class="ts"><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> Authentication - Standalone</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> The application/client id used to idenitfy the client.</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">AUTH_CLIENT_ID</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> Authentication - Standalone</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> The client secret that comes from the authentication provider.</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">AUTH_CLIENT_SECRET</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> Authentication - Standalone</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Additional information used during authentication process. For Azure AD, this will be the &#39;Tenant Id&#39;. For Keycloak, this will be the url issuer including the realm.</span><br/><span class="hl-3"> * </span><span class="hl-4">@example</span><span class="hl-3"> Keycloak</span><br/><span class="hl-3"> * https://my-keycloak-domain.com/realms/My_Realm</span><br/><span class="hl-3"> * </span><span class="hl-4">@example</span><span class="hl-3"> Azure</span><br/><span class="hl-3"> * 4a62fd3e-be14-443f-b51d-a9facca4a0eb</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">AUTH_ISSUER</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> Authentication - Standalone</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> The authentication provider used for logging in. Either keycloak or ad.</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">AUTH_PROVIDER</span><span class="hl-0">?: </span><span class="hl-6">&quot;keycloak&quot;</span><span class="hl-0"> | </span><span class="hl-6">&quot;ad&quot;</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> Authentication - Standalone</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Secret key used for NextAuth.js sessions.</span><br/><span class="hl-3"> */</span><br/><span class="hl-5">NEXTAUTH_SECRET</span><span class="hl-0">: </span><span class="hl-1">string</span><span class="hl-0">;</span>
</code><button type="button">Copy</button></pre>

<h3 id="metadata---ecr-library" class="tsd-anchor-link">Metadata - eCR Library<a href="#metadata---ecr-library" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>If using either <code>NON_INTEGRATED</code> or <code>DUAL</code>, metadata db environments will be required.</p>
<pre><code class="ts"><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> eCR Library Metadata</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Connection URL for the database.</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">DATABASE_URL</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> eCR Library Metadata</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Cipher key for database encryption if different then the default.</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">DB_CIPHER</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> SQL Server</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Hostname for SQL Server database.</span><br/><span class="hl-3"> * </span><span class="hl-4">@deprecated</span><span class="hl-3"> Since v3.1.0 - use </span><span class="hl-8">{</span><span class="hl-4">@link</span><span class="hl-8"> </span><span class="hl-1">DATABASE_URL</span><span class="hl-8">}</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">SQL_SERVER_HOST</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> SQL Server</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Password for SQL Server authentication.</span><br/><span class="hl-3"> * </span><span class="hl-4">@deprecated</span><span class="hl-3"> Since v3.1.0 - use </span><span class="hl-8">{</span><span class="hl-4">@link</span><span class="hl-8"> </span><span class="hl-1">DATABASE_URL</span><span class="hl-8">}</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">SQL_SERVER_PASSWORD</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span><br/><span class="hl-3">/**</span><br/><span class="hl-3"> * </span><span class="hl-4">@category</span><span class="hl-3"> SQL Server</span><br/><span class="hl-3"> * </span><span class="hl-4">@description</span><span class="hl-3"> Username for SQL Server authentication.</span><br/><span class="hl-3"> * </span><span class="hl-4">@deprecated</span><span class="hl-3"> Since v3.1.0 - use </span><span class="hl-8">{</span><span class="hl-4">@link</span><span class="hl-8"> </span><span class="hl-1">DATABASE_URL</span><span class="hl-8">}</span><br/><span class="hl-3"> */</span><br/><span class="hl-7">SQL_SERVER_USER</span><span class="hl-0">?: </span><span class="hl-1">string</span><span class="hl-0">;</span>
</code><button type="button">Copy</button></pre>

<h3 id="removed-environment-variables" class="tsd-anchor-link">Removed Environment Variables<a href="#removed-environment-variables" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>In order to maintain a history, these are variables that have been retired and no longer have a use in the app.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
<th>Version Removed</th>
<th>Date Removed</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="inserting-data" class="tsd-anchor-link">Inserting data<a href="#inserting-data" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="from-rhapsody" class="tsd-anchor-link">From Rhapsody<a href="#from-rhapsody" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Data can be added to the eCR Viewer as a step in Rhapsody.</p>
<pre><code class="js"><span class="hl-1">Placeholder</span><span class="hl-0"> </span><span class="hl-1">script</span>
</code><button type="button">Copy</button></pre>

<h3 id="from-api" class="tsd-anchor-link">From API<a href="#from-api" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Data can be added directly via API requeset to eCR Viewer's /process-zip endpoint.</p>
<pre><code class="bash"><span class="hl-9">curl</span><span class="hl-0"> </span><span class="hl-4">--location</span><span class="hl-0"> </span><span class="hl-6">&#39;{URL}/ecr-viewer/api/process-zip&#39;</span><span class="hl-0"> </span><span class="hl-10">\</span><br/><span class="hl-0">--form </span><span class="hl-6">&#39;upload_file=@&quot;/path/to/eicr.zip&quot;;type=application/zip&#39;</span>
</code><button type="button">Copy</button></pre>

<h2 id="database-setup" class="tsd-anchor-link">Database Setup<a href="#database-setup" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="../assets/icons.svg#icon-anchor"></use></svg></a></h2><p>Database setup, migration, and updates are handled at app startup by <a href="https://kysely.dev/docs/migrations">Kysely</a>. There is no need to run any other scripts manually.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="../assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#ecr-viewer-setup-guide"><span>eCR <wbr/>Viewer <wbr/>Setup <wbr/>Guide</span></a><ul><li><a href="#general-background"><span>General <wbr/>Background</span></a></li><li><ul><li><a href="#integrated-architecture-diagram"><span>Integrated <wbr/>Architecture <wbr/>Diagram</span></a></li><li><a href="#non-integrated-architecture-diagram"><span>Non <wbr/>Integrated <wbr/>Architecture <wbr/>Diagram</span></a></li><li><a href="#dual-architecture-diagram"><span>Dual <wbr/>Architecture <wbr/>Diagram</span></a></li></ul></li><li><a href="#environment-variable-setup"><span>Environment <wbr/>Variable <wbr/>Setup</span></a></li><li><ul><li><a href="#base-required"><span>Base <wbr/>Required</span></a></li><li><a href="#authentication-setup"><span>Authentication <wbr/>Setup</span></a></li><li><ul><li><a href="#integrated-authentication"><span>Integrated <wbr/>Authentication</span></a></li><li><a href="#non-integrated-authentication"><span>Non <wbr/>Integrated <wbr/>Authentication</span></a></li></ul></li><li><a href="#metadata---ecr-library"><span>Metadata -<wbr/> eCR <wbr/>Library</span></a></li><li><a href="#removed-environment-variables"><span>Removed <wbr/>Environment <wbr/>Variables</span></a></li></ul></li><li><a href="#inserting-data"><span>Inserting data</span></a></li><li><ul><li><a href="#from-rhapsody"><span>From <wbr/>Rhapsody</span></a></li><li><a href="#from-api"><span>From API</span></a></li></ul></li><li><a href="#database-setup"><span>Database <wbr/>Setup</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="../modules.html">ecr-viewer</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div>
<script type="module">
import mermaid from "https://unpkg.com/mermaid@latest/dist/mermaid.esm.min.mjs";

document.documentElement.classList.add("mermaid-enabled");

mermaid.initialize({startOnLoad:true});

requestAnimationFrame(function check() {
  let some = false;
  document.querySelectorAll("div.mermaid:not([data-inserted])").forEach(div => {
    some = true;
    if (div.querySelector("svg")) {
      div.dataset.inserted = true;
    }
  });

  if (some) {
    requestAnimationFrame(check);
  }
});
</script>
</body></html>
